Files with Chinese (excluding deprecated, errors, tests, docs):

.\api_utils\__init__.py: 12 lines
  2: APIå·¥å…·æ¨¡å—
  3: æä¾›FastAPIåº”ç”¨åˆå§‹åŒ–ã€è·¯ç”±å¤„ç†å’Œå·¥å…·å‡½æ•°
  6: # åº”ç”¨åˆå§‹åŒ–
  9: # é˜Ÿåˆ—å·¥ä½œå™¨
  12: # è¯·æ±‚å¤„ç†å™¨
  17: # è·¯ç”±å¤„ç†å™¨ï¼ˆæ”¹ä¸ºä» routers èšåˆå¯¼å…¥ï¼‰
  34: # å·¥å…·å‡½æ•°
  48: # åº”ç”¨åˆå§‹åŒ–
  50: # è·¯ç”±å‡¦ç†å™¨
  59: # å·¥å…·å‡½æ•°
  70: # è¯·æ±‚å¤„ç†å™¨
  72: # é˜Ÿåˆ—å·¥ä½œå™¨

.\api_utils\dependencies.py: 2 lines
  2: FastAPI ä¾èµ–é¡¹æ¨¡å—
  50: # è¿”å›ä¸å¯å˜å¿«ç…§ï¼Œé¿å…ä¸‹æ¸¸ä¿®æ”¹å…¨å±€å¼•ç”¨

.\api_utils\response_payloads.py: 1 lines
  17: """æ„é€  OpenAI å…¼å®¹çš„éæµå¼ chat.completion JSON å“åº”ã€‚"""

.\api_utils\routers\logs_ws.py: 1 lines
  32: f"æ—¥å¿— WebSocket (å®¢æˆ·ç«¯ {client_id}) å‘ç”Ÿå¼‚å¸¸: {e}", exc_info=True

.\api_utils\routers\queue.py: 2 lines
  24: logger.info("åœ¨é˜Ÿåˆ—ä¸­æ‰¾åˆ°è¯·æ±‚ï¼Œæ ‡è®°ä¸ºå·²å–æ¶ˆã€‚")
  42: logger.info("æ”¶åˆ°å–æ¶ˆè¯·æ±‚ã€‚")

.\api_utils\utils_ext\helper.py: 3 lines
  12: logger.info(f"æ­£åœ¨å°è¯•ä½¿ç”¨Helperç«¯ç‚¹: {helper_endpoint}")
  26: logger.error(f"Helperç«¯ç‚¹è¿”å›é”™è¯¯çŠ¶æ€: {response.status}")
  30: logger.error(f"ä½¿ç”¨Helperç«¯ç‚¹æ—¶å‡ºé”™: {e}")

.\browser_utils\debug_utils.py: 2 lines
  437: error_stage: Description of error stage (e.g., "æµå¼å“åº”åæŒ‰é’®çŠ¶æ€æ£€æŸ¥")
  739: f"[{req_id}] æµè§ˆå™¨/é¡µé¢ä¸å¯ç”¨ ({base_error_name})ï¼Œä¿å­˜æœ€å°åŒ–å¿«ç…§..."

.\browser_utils\initialization\auth.py: 13 lines
  3: è®¤è¯ä¿å­˜æ¨¡å— - ç®€åŒ–ç‰ˆ
  5: å¤„ç†ç™»å½•åçš„è®¤è¯çŠ¶æ€ä¿å­˜ã€‚è‡ªåŠ¨ä¿å­˜åˆ° SAVED_AUTH_DIRã€‚
  19: """ç­‰å¾…æ¨¡å‹åˆ—è¡¨å“åº”å¹¶å¤„ç†è®¤è¯ä¿å­˜"""
  22: # ç­‰å¾…æ¨¡å‹åˆ—è¡¨å“åº”ï¼Œç¡®è®¤ç™»å½•æˆåŠŸ
  23: logger.info("ç­‰å¾…æ¨¡å‹åˆ—è¡¨å“åº”ä»¥ç¡®è®¤ç™»å½•æˆåŠŸ...")
  26: logger.info("æ£€æµ‹åˆ°æ¨¡å‹åˆ—è¡¨å“åº”ï¼Œç™»å½•ç¡®è®¤æˆåŠŸï¼")
  28: logger.warning("ç­‰å¾…æ¨¡å‹åˆ—è¡¨å“åº”è¶…æ—¶ï¼Œä½†ç»§ç»­å¤„ç†è®¤è¯ä¿å­˜...")
  39: """ç»Ÿä¸€çš„è®¤è¯ä¿å­˜å‡½æ•°"""
  47: print("ç™»å½•æˆåŠŸï¼å°†è‡ªåŠ¨ä¿å­˜è®¤è¯çŠ¶æ€...", flush=True)
  51: logger.info(f"è®¤è¯çŠ¶æ€å·²ä¿å­˜åˆ°: {auth_save_path}")
  52: print(f"è®¤è¯çŠ¶æ€å·²ä¿å­˜åˆ°: {auth_save_path}", flush=True)
  56: logger.error(f"ä¿å­˜è®¤è¯çŠ¶æ€å¤±è´¥: {e}", exc_info=True)
  57: print(f"ä¿å­˜è®¤è¯çŠ¶æ€å¤±è´¥: {e}", flush=True)

.\browser_utils\models\startup.py: 43 lines
  20: """å¤„ç†åˆå§‹æ¨¡å‹çŠ¶æ€å’Œå­˜å‚¨"""
  27: logger.debug("[Init] å¤„ç†åˆå§‹æ¨¡å‹çŠ¶æ€å’Œ localStorage...")
  37: reason_for_reload = "localStorage æœªæ‰¾åˆ°"
  49: reason_for_reload = "promptModel æ— æ•ˆ"
  51: # ä½¿ç”¨æ–°çš„UIçŠ¶æ€éªŒè¯åŠŸèƒ½
  55: reason_for_reload = "UIçŠ¶æ€ä¸åŒ¹é…"
  61: f"localStorage æœ‰æ•ˆä¸”UIçŠ¶æ€æ­£ç¡®ã€‚åˆå§‹æ¨¡å‹ ID ä» localStorage è®¾ç½®ä¸º: {state.current_ai_studio_model_id}"
  66: "è§£æ localStorage.aiStudioUserPreference JSON å¤±è´¥ã€‚"
  68: logger.error(f"åˆ¤å®šéœ€è¦åˆ·æ–°å’Œå­˜å‚¨æ›´æ–°: {reason_for_reload}")
  71: logger.debug(f"[State] éœ€è¦åˆ·æ–°: {reason_for_reload}")
  75: logger.info("[UIæ“ä½œ] æ­£åœ¨é‡æ–°åŠ è½½é¡µé¢ä»¥åº”ç”¨è®¾ç½®...")
  80: f"å°è¯•é‡æ–°åŠ è½½é¡µé¢ (ç¬¬ {attempt + 1}/{max_retries} æ¬¡): {current_page_url}"
  88: logger.debug(f"é¡µé¢å·²æˆåŠŸé‡æ–°åŠ è½½åˆ°: {page.url}")
  90: # é¡µé¢é‡æ–°åŠ è½½åéªŒè¯UIçŠ¶æ€
  91: logger.debug("[State] éªŒè¯ UI çŠ¶æ€...")
  96: logger.info("[UIæ£€æŸ¥] é¡µé¢é‡è½½åéªŒè¯é€šè¿‡")
  98: logger.warning("é‡æ–°åŠ è½½åUIçŠ¶æ€éªŒè¯å¤±è´¥")
  100: break  # æˆåŠŸåˆ™è·³å‡ºå¾ªç¯
  105: f"é¡µé¢é‡æ–°åŠ è½½å°è¯• {attempt + 1}/{max_retries} å¤±è´¥: {reload_err}"
  108: logger.debug("[Init] 5ç§’åé‡è¯•...")
  112: f"é¡µé¢é‡æ–°åŠ è½½åœ¨ {max_retries} æ¬¡å°è¯•åæœ€ç»ˆå¤±è´¥: {reload_err}. åç»­æ¨¡å‹çŠ¶æ€å¯èƒ½ä¸å‡†ç¡®ã€‚",
  121: logger.debug("[State] é‡è½½ååŒæ­¥æ¨¡å‹ ID")
  123: logger.debug(f"[State] å®Œæˆï¼Œå½“å‰æ¨¡å‹: {state.current_ai_studio_model_id}")
  125: logger.debug("[State] localStorage çŠ¶æ€æ­£å¸¸ï¼Œæ— éœ€åˆ·æ–°")
  130: f"(æ–°) å¤„ç†åˆå§‹æ¨¡å‹çŠ¶æ€å’Œ localStorage æ—¶å‘ç”Ÿä¸¥é‡é”™è¯¯: {e}",
  135: "ç”±äºå‘ç”Ÿé”™è¯¯ï¼Œå°è¯•å›é€€ä»…ä»é¡µé¢æ˜¾ç¤ºè®¾ç½®å…¨å±€æ¨¡å‹ ID (ä¸å†™å…¥localStorage)..."
  141: logger.error(f"å›é€€è®¾ç½®æ¨¡å‹IDä¹Ÿå¤±è´¥: {fallback_err}")
  145: """ä»é¡µé¢æ˜¾ç¤ºè®¾ç½®æ¨¡å‹"""
  153: logger.debug("[Model] ä»é¡µé¢æ˜¾ç¤ºè¯»å–å½“å‰æ¨¡å‹...")
  159: logger.debug(f"[Model] é¡µé¢æ˜¾ç¤º: '{displayed_model_name}'")
  163: logger.debug("[Model] ç­‰å¾…æ¨¡å‹åˆ—è¡¨æ•°æ® (æœ€å¤š 5 ç§’)...")
  167: logger.warning("ç­‰å¾…æ¨¡å‹åˆ—è¡¨è¶…æ—¶ï¼Œå¯èƒ½æ— æ³•å‡†ç¡®è½¬æ¢æ˜¾ç¤ºåç§°ä¸ºIDã€‚")
  174: logger.debug(f"[Model] å…¨å±€ ID å·²æ›´æ–°: {new_model_value}")
  178: logger.debug("[State] å‡†å¤‡æ›´æ–° localStorage")
  188: "è§£æç°æœ‰ localStorage.aiStudioUserPreference å¤±è´¥ï¼Œå°†åˆ›å»ºæ–°çš„åå¥½è®¾ç½®ã€‚"
  191: # ä½¿ç”¨æ–°çš„å¼ºåˆ¶è®¾ç½®åŠŸèƒ½
  192: logger.debug("[State] åº”ç”¨å¼ºåˆ¶ UI çŠ¶æ€è®¾ç½®...")
  195: logger.warning("UIçŠ¶æ€è®¾ç½®å¤±è´¥ï¼Œä½¿ç”¨ä¼ ç»Ÿæ–¹æ³•")
  199: # ç¡®ä¿prefs_to_setä¹ŸåŒ…å«æ­£ç¡®çš„è®¾ç½®
  202: logger.debug("[State] å·²è®¾ç½®: isAdvancedOpen=true, areToolsOpen=true")
  209: f"æ— æ³•ä»é¡µé¢æ˜¾ç¤º '{displayed_model_name}' æ‰¾åˆ°æ¨¡å‹IDï¼Œä¸” localStorage ä¸­æ— ç°æœ‰ promptModelã€‚promptModel å°†ä¸ä¼šè¢«ä¸»åŠ¨è®¾ç½®ä»¥é¿å…æ½œåœ¨é—®é¢˜ã€‚"
  234: f"[State] localStorage å·²æ›´æ–° (model: {prefs_to_set.get('promptModel', 'N/A')})"
  239: logger.error(f"å°è¯•ä»é¡µé¢æ˜¾ç¤ºè®¾ç½®æ¨¡å‹æ—¶å‡ºé”™: {e_set_disp}", exc_info=True)

.\browser_utils\more_models.js: 83 lines
  2: // @name         Google AI Studio æ¨¡å‹æ³¨å…¥å™¨
  5: // @description  å‘ Google AI Studio æ³¨å…¥è‡ªå®šä¹‰æ¨¡å‹ï¼Œæ”¯æŒä¸»é¢˜è¡¨æƒ…å›¾æ ‡ã€‚æ‹¦æˆª XHR/Fetch è¯·æ±‚ï¼Œå¤„ç†æ•°ç»„ç»“æ„çš„ JSON æ•°æ®
  17: // ==================== é…ç½®åŒºåŸŸ ====================
  18: // è„šæœ¬å·²ç»å¤±æ•ˆ
  21: const LOG_PREFIX = `[AI Studio æ³¨å…¥å™¨ ${SCRIPT_VERSION}]`;
  24: // æ¨¡å‹é…ç½®åˆ—è¡¨
  25: // å·²æŒ‰è¦æ±‚å°† jfdksal98a æ”¾åˆ° blacktooth çš„ä¸‹é¢
  28: //ä¸‹é¢æ¨¡å‹å·²ç»å…¨éƒ¨å¤±æ•ˆï¼Œç•™ä¸‹æ¥æ€€å¿µ
  32: // { name: 'models/blacktooth-ab-test', displayName: `ğŸ´â€â˜ ï¸ Blacktooth (è„šæœ¬ ${SCRIPT_VERSION})`, description: `ç”±è„šæœ¬ ${SCRIP
  33: // { name: 'models/jfdksal98a', displayName: `ğŸª jfdksal98a (è„šæœ¬ ${SCRIPT_VERSION})`, description: `ç”±è„šæœ¬ ${SCRIPT_VERSION} 
  34: // { name: 'models/gemini-2.5-pro-preview-03-25', displayName: `âœ¨ Gemini 2.5 Pro 03-25 (è„šæœ¬ ${SCRIPT_VERSION})`, descript
  35: // { name: 'models/goldmane-ab-test', displayName: `ğŸ¦ Goldmane (è„šæœ¬ ${SCRIPT_VERSION})`, description: `ç”±è„šæœ¬ ${SCRIPT_VERSI
  36: // { name: 'models/claybrook-ab-test', displayName: `ğŸ’§ Claybrook (è„šæœ¬ ${SCRIPT_VERSION})`, description: `ç”±è„šæœ¬ ${SCRIPT_VER
  37: // { name: 'models/frostwind-ab-test', displayName: `â„ï¸ Frostwind (è„šæœ¬ ${SCRIPT_VERSION})`, description: `ç”±è„šæœ¬ ${SCRIPT_VE
  38: // { name: 'models/calmriver-ab-test', displayName: `ğŸŒŠ Calmriver (è„šæœ¬ ${SCRIPT_VERSION})`, description: `ç”±è„šæœ¬ ${SCRIPT_VER
  41: // JSON ç»“æ„ä¸­çš„å­—æ®µç´¢å¼•
  49: // ==================== å·¥å…·å‡½æ•° ====================
  52: * æ£€æŸ¥ URL æ˜¯å¦ä¸ºç›®æ ‡ API ç«¯ç‚¹
  53: * @param {string} url - è¦æ£€æŸ¥çš„ URL
  63: * é€’å½’æŸ¥æ‰¾æ¨¡å‹åˆ—è¡¨æ•°ç»„
  64: * @param {any} obj - è¦æœç´¢çš„å¯¹è±¡
  65: * @returns {Array|null} æ‰¾åˆ°çš„æ¨¡å‹æ•°ç»„æˆ– null
  70: // æ£€æŸ¥æ˜¯å¦ä¸ºç›®æ ‡æ¨¡å‹æ•°ç»„
  79: // é€’å½’æœç´¢å­å¯¹è±¡
  94: * æŸ¥æ‰¾åˆé€‚çš„æ¨¡æ¿æ¨¡å‹
  95: * @param {Array} modelsArray - æ¨¡å‹æ•°ç»„
  96: * @returns {Array|null} æ¨¡æ¿æ¨¡å‹æˆ– null
  99: // ä¼˜å…ˆæŸ¥æ‰¾åŒ…å«ç‰¹å®šå…³é”®è¯çš„æ¨¡å‹
  117: * æ›´æ–°å·²å­˜åœ¨æ¨¡å‹çš„æ˜¾ç¤ºåç§°
  118: * @param {Array} existingModel - ç°æœ‰æ¨¡å‹
  119: * @param {Object} modelToInject - è¦æ³¨å…¥çš„æ¨¡å‹é…ç½®
  120: * @returns {boolean} æ˜¯å¦è¿›è¡Œäº†æ›´æ–°
  127: // æå–åŸºç¡€åç§°ï¼ˆå»é™¤ç‰ˆæœ¬å·å’Œè¡¨æƒ…ï¼‰
  128: // æ›´æ–°æ­£åˆ™è¡¨è¾¾å¼ä»¥åŒ¹é… vX.Y.Z æ ¼å¼
  130: .replace(/ \(è„šæœ¬ v\d+\.\d+(\.\d+)?(-beta\d*)?\)/, '')
  131: // åŒ…å«æ‰€æœ‰å½“å‰ä½¿ç”¨çš„è¡¨æƒ…ï¼ŒåŒ…æ‹¬æ–°å¢çš„ ğŸ´â€â˜ ï¸, ğŸ¤–, ğŸª
  139: // ä»…æ›´æ–°ç‰ˆæœ¬å·å’Œè¡¨æƒ…
  141: console.log(LOG_PREFIX, `å·²æ›´æ–°è¡¨æƒ…/ç‰ˆæœ¬å·: ${modelToInject.displayName}`);
  143: // æ ‡è®°ä¸ºåŸå§‹æ¨¡å‹
  144: existingModel[MODEL_FIELDS.DISPLAY_NAME] = modelToInject.displayName + " (åŸå§‹)";
  145: console.log(LOG_PREFIX, `å·²æ›´æ–°å®˜æ–¹æ¨¡å‹ ${modelToInject.name} çš„æ˜¾ç¤ºåç§°`);
  151: * åˆ›å»ºæ–°æ¨¡å‹
  152: * @param {Array} templateModel - æ¨¡æ¿æ¨¡å‹
  153: * @param {Object} modelToInject - è¦æ³¨å…¥çš„æ¨¡å‹é…ç½®
  154: * @param {string} templateName - æ¨¡æ¿åç§°
  155: * @returns {Array} æ–°æ¨¡å‹æ•°ç»„
  162: newModel[MODEL_FIELDS.DESCRIPTION] = `${modelToInject.description} (åŸºäº ${templateName} ç»“æ„)`;
  176: // ==================== æ ¸å¿ƒå¤„ç†å‡½æ•° ====================
  179: * å¤„ç†å¹¶ä¿®æ”¹ JSON æ•°æ®
  180: * @param {Object} jsonData - åŸå§‹ JSON æ•°æ®
  181: * @param {string} url - è¯·æ±‚ URL
  182: * @returns {Object} åŒ…å«å¤„ç†åæ•°æ®å’Œä¿®æ”¹æ ‡å¿—çš„å¯¹è±¡
  189: console.warn(LOG_PREFIX, 'åœ¨ JSON ä¸­æœªæ‰¾åˆ°æœ‰æ•ˆçš„æ¨¡å‹åˆ—è¡¨ç»“æ„:', url);
  193: // æŸ¥æ‰¾æ¨¡æ¿æ¨¡å‹
  198: console.warn(LOG_PREFIX, 'æœªæ‰¾åˆ°åˆé€‚çš„æ¨¡æ¿æ¨¡å‹ï¼Œæ— æ³•æ³¨å…¥æ–°æ¨¡å‹');
  201: // åå‘éå†ä»¥ä¿æŒæ˜¾ç¤ºé¡ºåº (é…ç½®ä¸­é å‰çš„æ¨¡å‹æ˜¾ç¤ºåœ¨æœ€ä¸Šé¢)
  208: // æ³¨å…¥æ–°æ¨¡å‹
  210: console.warn(LOG_PREFIX, `æ— æ³•æ³¨å…¥ ${modelToInject.name}ï¼šç¼ºå°‘æ¨¡æ¿`);
  215: modelsArray.unshift(newModel); // unshift å°†æ¨¡å‹æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
  217: console.log(LOG_PREFIX, `æˆåŠŸæ³¨å…¥: ${modelToInject.displayName}`);
  219: // æ›´æ–°ç°æœ‰æ¨¡å‹
  230: * ä¿®æ”¹å“åº”ä½“
  231: * @param {string} originalText - åŸå§‹å“åº”æ–‡æœ¬
  232: * @param {string} url - è¯·æ±‚ URL
  233: * @returns {string} ä¿®æ”¹åçš„å“åº”æ–‡æœ¬
  244: // å¤„ç†ååŠ«æŒå‰ç¼€
  263: console.error(LOG_PREFIX, 'å¤„ç†å“åº”ä½“æ—¶å‡ºé”™:', url, error);
  269: // ==================== è¯·æ±‚æ‹¦æˆª ====================
  271: // æ‹¦æˆª Fetch API
  279: console.log(LOG_PREFIX, '[Fetch] æ‹¦æˆªåˆ°ç›®æ ‡è¯·æ±‚:', url);
  293: console.error(LOG_PREFIX, '[Fetch] å¤„ç†é”™è¯¯:', e);
  299: // æ‹¦æˆª XMLHttpRequest
  306: // é‡å†™ open æ–¹æ³•
  313: console.log(LOG_PREFIX, `[XHR] æ£€æµ‹åˆ°ç›®æ ‡è¯·æ±‚ (${interceptionCount})ï¼š`, url);
  320: * å¤„ç† XHR å“åº”
  321: * @param {XMLHttpRequest} xhr - XHR å¯¹è±¡
  322: * @param {any} originalValue - åŸå§‹å“åº”å€¼
  323: * @param {string} type - å“åº”ç±»å‹
  324: * @returns {any} å¤„ç†åçš„å“åº”å€¼
  349: console.error(LOG_PREFIX, '[XHR] è§£æç¼“å­˜çš„ JSON æ—¶å‡ºé”™:', e);
  356: // é‡å†™ responseText å±æ€§
  372: // é‡å†™ response å±æ€§
  392: console.log(LOG_PREFIX, 'è„šæœ¬å·²æ¿€æ´»ï¼ŒFetch å’Œ XHR æ‹¦æˆªå·²å¯ç”¨');

.\browser_utils\operations_modules\parsers.py: 62 lines
  19: """ä»æ²¹çŒ´è„šæœ¬ä¸­è§£ææ¨¡å‹åˆ—è¡¨ - ä½¿ç”¨JSONè§£ææ–¹å¼"""
  21: # æŸ¥æ‰¾è„šæœ¬ç‰ˆæœ¬å·
  26: # æŸ¥æ‰¾ MODELS_TO_INJECT æ•°ç»„çš„å†…å®¹
  31: logger.warning("æœªæ‰¾åˆ° MODELS_TO_INJECT æ•°ç»„")
  36: # å°†JavaScriptæ•°ç»„è½¬æ¢ä¸ºJSONæ ¼å¼
  37: # 1. æ›¿æ¢æ¨¡æ¿å­—ç¬¦ä¸²ä¸­çš„å˜é‡
  40: # 2. ç§»é™¤JavaScriptæ³¨é‡Š
  43: # 3. å°†JavaScriptå¯¹è±¡è½¬æ¢ä¸ºJSONæ ¼å¼
  44: # ç§»é™¤å°¾éšé€—å·
  47: # æ›¿æ¢å•å¼•å·ä¸ºåŒå¼•å·
  49: # æ›¿æ¢åå¼•å·ä¸ºåŒå¼•å·
  51: # ç¡®ä¿å±æ€§åç”¨åŒå¼•å·
  54: # 4. è§£æJSON
  70: logger.info(f"æˆåŠŸè§£æ {len(models)} ä¸ªæ¨¡å‹ä»æ²¹çŒ´è„šæœ¬")
  74: logger.error(f"è§£ææ²¹çŒ´è„šæœ¬æ¨¡å‹åˆ—è¡¨å¤±è´¥: {e}", exc_info=True)
  79: """ä»æ²¹çŒ´è„šæœ¬ä¸­è·å–æ³¨å…¥çš„æ¨¡å‹åˆ—è¡¨ï¼Œè½¬æ¢ä¸ºAPIæ ¼å¼"""
  81: # ç›´æ¥è¯»å–ç¯å¢ƒå˜é‡ï¼Œé¿å…å¤æ‚çš„å¯¼å…¥
  89: # è·å–è„šæœ¬æ–‡ä»¶è·¯å¾„
  92: # æ£€æŸ¥è„šæœ¬æ–‡ä»¶æ˜¯å¦å­˜åœ¨
  94: # è„šæœ¬æ–‡ä»¶ä¸å­˜åœ¨ï¼Œé™é»˜è¿”å›ç©ºåˆ—è¡¨
  97: # è¯»å–æ²¹çŒ´è„šæœ¬å†…å®¹
  101: # ä»è„šæœ¬ä¸­è§£ææ¨¡å‹åˆ—è¡¨
  107: # è½¬æ¢ä¸ºAPIæ ¼å¼
  112: continue  # è·³è¿‡æ²¡æœ‰åç§°çš„æ¨¡å‹
  115: simple_id = model_name[7:]  # ç§»é™¤ 'models/' å‰ç¼€
  124: # æ³¨æ„ï¼šä¸å†æ¸…ç†æ˜¾ç¤ºåç§°ï¼Œä¿ç•™åŸå§‹çš„emojiå’Œç‰ˆæœ¬ä¿¡æ¯
  138: "injected": True,  # æ ‡è®°ä¸ºæ³¨å…¥çš„æ¨¡å‹
  145: # é™é»˜å¤„ç†é”™è¯¯ï¼Œä¸è¾“å‡ºæ—¥å¿—ï¼Œè¿”å›ç©ºåˆ—è¡¨
  150: """å¤„ç†æ¨¡å‹åˆ—è¡¨å“åº”"""
  151: # éœ€è¦è®¿é—®å…¨å±€å˜é‡
  160: # æ£€æŸ¥æ˜¯å¦åœ¨ç™»å½•æµç¨‹ä¸­
  167: # åœ¨ç™»å½•æµç¨‹ä¸­ï¼Œé™é»˜å¤„ç†ï¼Œä¸è¾“å‡ºå¹²æ‰°ä¿¡æ¯
  168: pass  # é™é»˜å¤„ç†ï¼Œé¿å…å¹²æ‰°ç”¨æˆ·è¾“å…¥
  170: logger.debug(f"[Network] æ•è·æ¨¡å‹åˆ—è¡¨å“åº” ({response.status} OK)")
  194: f"æœªçŸ¥çš„åˆ—è¡¨åµŒå¥—ç»“æ„ã€‚data[0] ç±»å‹: {type(data[0]) if data else 'N/A'}ã€‚data[0] é¢„è§ˆ: {str(data[0])[:200] if data else 'N/A'}"
  210: f"æ¨¡å‹åˆ—è¡¨æ•°æ®åœ¨ '{key}' é”®ä¸‹é€šè¿‡å¯å‘å¼æœç´¢æ‰¾åˆ°ã€‚"
  214: logger.warning("åœ¨å­—å…¸å“åº”ä¸­æœªèƒ½è‡ªåŠ¨å®šä½æ¨¡å‹åˆ—è¡¨æ•°ç»„ã€‚")
  223: f"æ¥æ”¶åˆ°çš„æ¨¡å‹åˆ—è¡¨æ•°æ®æ—¢ä¸æ˜¯åˆ—è¡¨ä¹Ÿä¸æ˜¯å­—å…¸: {type(data)}"
  231: excluded_during_parse: list[str] = []  # æ”¶é›†è¢«æ’é™¤çš„æ¨¡å‹ID
  305: f"æ¨¡å‹ {current_model_id_for_log}: æ— æ³•å°†åˆ—è¡¨ç´¢å¼•6çš„å€¼ '{model_fields_list[6]}' è§£æä¸º max_output_tokensã€‚"
  316: f"æ¨¡å‹ {current_model_id_for_log}: åŸå§‹ top_på€¼ {raw_top_p} (æ¥è‡ªåˆ—è¡¨ç´¢å¼•9) è¶…å‡º [0,1] èŒƒå›´ï¼Œå°†è£å‰ªã€‚"
  325: f"æ¨¡å‹ {current_model_id_for_log}: æ— æ³•å°†åˆ—è¡¨ç´¢å¼•9çš„å€¼ '{model_fields_list[9]}' è§£æä¸º top_pã€‚"
  369: f"æ¨¡å‹ {current_model_id_for_log}: æ— æ³•å°†å­—å…¸å€¼ '{mot_parsed}' è§£æä¸º max_output_tokensã€‚"
  380: f"æ¨¡å‹ {current_model_id_for_log}: åŸå§‹ top_på€¼ {raw_top_p} (æ¥è‡ªå­—å…¸) è¶…å‡º [0,1] èŒƒå›´ï¼Œå°†è£å‰ªã€‚"
  389: f"æ¨¡å‹ {current_model_id_for_log}: æ— æ³•å°†å­—å…¸å€¼ '{top_p_parsed}' è§£æä¸º top_pã€‚"
  401: f"æ¨¡å‹ {current_model_id_for_log}: æ— æ³•å°†å­—å…¸å€¼ '{temp_parsed}' è§£æä¸º temperatureã€‚"
  410: f"è§£ææ¨¡å‹å­—æ®µæ—¶å‡ºé”™ for entry {str(entry_in_container)[:100]}: {e_parse_fields}"
  454: # æ£€æŸ¥æ˜¯å¦å·²ç»æœ‰é€šè¿‡ç½‘ç»œæ‹¦æˆªæ³¨å…¥çš„æ¨¡å‹
  462: # æ£€æŸ¥æ˜¯å¦æœ‰ç½‘ç»œæ³¨å…¥æ ‡è®°
  468: logger.info("æ£€æµ‹åˆ°ç½‘ç»œæ‹¦æˆªå·²æ³¨å…¥æ¨¡å‹")
  470: # æ³¨æ„ï¼šä¸å†åœ¨åç«¯æ·»åŠ æ³¨å…¥æ¨¡å‹
  471: # å› ä¸ºå¦‚æœå‰ç«¯æ²¡æœ‰é€šè¿‡ç½‘ç»œæ‹¦æˆªæ³¨å…¥ï¼Œè¯´æ˜å‰ç«¯é¡µé¢ä¸Šæ²¡æœ‰è¿™äº›æ¨¡å‹
  472: # åç«¯è¿”å›è¿™äº›æ¨¡å‹ä¹Ÿæ— æ³•å®é™…ä½¿ç”¨ï¼Œæ‰€ä»¥åªä¾èµ–ç½‘ç»œæ‹¦æˆªæ³¨å…¥
  487: logger.debug(f"[Model] å·²æ’é™¤ {excluded_count} ä¸ªæ¨¡å‹")
  488: log_output = f"[Model] åˆ—è¡¨æ›´æ–°: {current_count} ä¸ªæ¨¡å‹\n"
  498: logger.debug(f"[Model] åˆ—è¡¨æ— å˜åŒ– ({current_count} ä¸ª)")
  501: f"[æ¨¡å‹] åˆ—è¡¨å·²æ›´æ–° (å…± {len(state.parsed_model_list)} ä¸ªæ¨¡å‹)"
  506: logger.warning("è§£æåæ¨¡å‹åˆ—è¡¨ä»ç„¶ä¸ºç©ºã€‚")
  510: logger.warning("models_array_container ä¸º Noneï¼Œæ— æ³•è§£ææ¨¡å‹åˆ—è¡¨ã€‚")
  515: f"è§£ææ¨¡å‹åˆ—è¡¨JSONå¤±è´¥: {json_err}. å“åº” (å‰500å­—): {await response.text()[:500]}"
  520: logger.exception(f"å¤„ç†æ¨¡å‹åˆ—è¡¨å“åº”æ—¶å‘ç”ŸæœªçŸ¥é”™è¯¯: {e_handle_list_resp}")
  523: logger.info("å¤„ç†æ¨¡å‹åˆ—è¡¨å“åº”ç»“æŸï¼Œå¼ºåˆ¶è®¾ç½® model_list_fetch_eventã€‚")

.\config\selector_utils.py: 40 lines
  3: é€‰æ‹©å™¨å·¥å…·æ¨¡å—
  4: æä¾›ç”¨äºå¤„ç†åŠ¨æ€ UI ç»“æ„çš„é€‰æ‹©å™¨å›é€€é€»è¾‘
  21: # --- è¾“å…¥åŒºåŸŸå®¹å™¨é€‰æ‹©å™¨ (æŒ‰ä¼˜å…ˆçº§æ’åº) ---
  22: # Google AI Studio ä¼šä¸å®šæœŸæ›´æ”¹ UI ç»“æ„ï¼Œæ­¤åˆ—è¡¨åŒ…å«æ‰€æœ‰å·²çŸ¥çš„å®¹å™¨é€‰æ‹©å™¨
  23: # ä¼˜å…ˆå°è¯•å½“å‰ UIï¼Œå›é€€åˆ°æ—§ UI
  24: # æ³¨æ„: é¡ºåºå¾ˆé‡è¦ï¼ç¬¬ä¸€ä¸ªé€‰æ‹©å™¨ä¼šè¢«ä¼˜å…ˆå°è¯•ï¼Œæ¯ä¸ªå¤±è´¥çš„é€‰æ‹©å™¨ä¼šå¢åŠ å¯åŠ¨æ—¶é—´
  26: # å½“å‰ UI ç»“æ„ (2024-12 ç¡®è®¤æœ‰æ•ˆ)
  28: # å¤‡ç”¨ UI ç»“æ„ (å¯èƒ½åœ¨å…¶ä»–ç‰ˆæœ¬æˆ–åŒºåŸŸæœ‰æ•ˆ)
  31: # è¿‡æ¸¡æœŸ UI (ms-prompt-box) - å†å²ç‰ˆæœ¬ï¼Œä¿ç•™ä½œä¸ºå›é€€
  36: # --- è‡ªåŠ¨è°ƒæ•´å®¹å™¨é€‰æ‹©å™¨ ---
  38: # å½“å‰ UI ç»“æ„
  43: # è¿‡æ¸¡æœŸ UI (ms-prompt-box) - å·²å¼ƒç”¨ä½†ä¿ç•™ä½œä¸ºå›é€€
  58: å°è¯•å¤šä¸ªé€‰æ‹©å™¨å¹¶è¿”å›ç¬¬ä¸€ä¸ªå¯è§å…ƒç´ çš„ Locatorã€‚
  60: ä½¿ç”¨ä¸»åŠ¨ DOM ç›‘å¬ç­–ç•¥ (Playwright MutationObserver):
  61: - å¯¹ç¬¬ä¸€ä¸ªé€‰æ‹©å™¨ä½¿ç”¨è¾ƒé•¿è¶…æ—¶ï¼ˆä¸»é€‰æ‹©å™¨ï¼Œæœ€å¯èƒ½æˆåŠŸï¼‰
  62: - åç»­é€‰æ‹©å™¨ä½¿ç”¨è¾ƒçŸ­è¶…æ—¶ä½œä¸ºå›é€€
  65: page: Playwright é¡µé¢å®ä¾‹
  66: selectors: è¦å°è¯•çš„é€‰æ‹©å™¨åˆ—è¡¨ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰
  67: description: å…ƒç´ æè¿°ï¼ˆç”¨äºæ—¥å¿—è®°å½•ï¼‰
  68: timeout_per_selector: ä¸»é€‰æ‹©å™¨çš„è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  72: - å¯è§å…ƒç´ çš„ Locatorï¼Œå¦‚æœéƒ½å¤±è´¥åˆ™ä¸º None
  73: - æˆåŠŸçš„é€‰æ‹©å™¨å­—ç¬¦ä¸²ï¼Œå¦‚æœéƒ½å¤±è´¥åˆ™ä¸º None
  78: logger.warning(f"[Selector] {description}: æ²¡æœ‰æä¾›é€‰æ‹©å™¨")
  81: # ä¸»é€‰æ‹©å™¨ä½¿ç”¨è¾ƒé•¿è¶…æ—¶ï¼ˆæœ€å¯èƒ½æˆåŠŸï¼Œå€¼å¾—ç­‰å¾…ï¼‰
  85: # å›é€€é€‰æ‹©å™¨ä½¿ç”¨è¾ƒçŸ­è¶…æ—¶
  89: f"[Selector] {description}: å¼€å§‹ä¸»åŠ¨ç›‘å¬ '{primary_selector}' (è¶…æ—¶: {primary_timeout}ms)"
  92: # å°è¯•ä¸»é€‰æ‹©å™¨ï¼ˆä½¿ç”¨ Playwright çš„ MutationObserver ä¸»åŠ¨ç›‘å¬ï¼‰
  96: logger.debug(f"[Selector] {description}: '{primary_selector}' å…ƒç´ å¯è§")
  102: f"[Selector] {description}: '{primary_selector}' è¶…æ—¶ ({primary_timeout}ms) - {type(e).__name__}"
  105: # å›é€€åˆ°å…¶ä»–é€‰æ‹©å™¨
  108: f"[Selector] {description}: å°è¯• {len(selectors) - 1} ä¸ªå›é€€é€‰æ‹©å™¨ (è¶…æ—¶: {fallback_timeout}ms)"
  115: f"[Selector] {description}: '{selector}' å…ƒç´ å¯è§ (å›é€€ {idx}/{len(selectors)})"
  122: f"[Selector] {description}: '{selector}' è¶…æ—¶ (å›é€€ {idx}/{len(selectors)})"
  126: f"[Selector] {description}: æ‰€æœ‰é€‰æ‹©å™¨å‡æœªæ‰¾åˆ°å¯è§å…ƒç´  "
  127: f"(å°è¯•äº† {len(selectors)} ä¸ªé€‰æ‹©å™¨)"
  134: å°†å¤šä¸ªé€‰æ‹©å™¨ç»„åˆä¸ºå•ä¸ª CSS é€‰æ‹©å™¨å­—ç¬¦ä¸²ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰ã€‚
  136: è¿™å¯¹äºåˆ›å»ºèƒ½åŒ¹é…å¤šä¸ª UI ç»“æ„çš„é€‰æ‹©å™¨å¾ˆæœ‰ç”¨ã€‚
  139: selectors: è¦ç»„åˆçš„é€‰æ‹©å™¨åˆ—è¡¨
  142: str: ç»„åˆåçš„é€‰æ‹©å™¨å­—ç¬¦ä¸²
  149: # è¿”å›: "ms-prompt-box .text-wrapper, ms-prompt-input-wrapper .text-wrapper"

.\launch_camoufox.py: 12 lines
  354: # Check for localized "command not found" messages (e.g., "æœªæ‰¾åˆ°å‘½ä»¤" for Chinese systems)
  355: elif process.returncode != 0 and ("command not found" in stderr.lower() or "æœªæ‰¾åˆ°å‘½ä»¤" in stderr):
  405: # Check for localized "Success" messages (e.g., "æˆåŠŸ" for Chinese systems)
  406: if result.returncode == 0 and ("SUCCESS" in output.upper() or "æˆåŠŸ" in output):
  409: # Check for localized "Not Found" messages (e.g., "æ‰¾ä¸åˆ°" for Chinese systems)
  410: elif "could not find process" in error_output.lower() or "æ‰¾ä¸åˆ°" in error_output: # Process might have exited itself
  1162: # ä¿®å¤: å¦‚æœå‘½ä»¤è¡Œå‚æ•°æœªæä¾›ï¼Œåˆ™ä¿æŒç¯å¢ƒå˜é‡ä¸­çš„åŸå§‹å€¼
  1163: # è¿™æ ·å¯ä»¥å°Šé‡ .env æ–‡ä»¶ä¸­çš„é…ç½®
  1166: # å¦åˆ™ä¿æŒç°æœ‰çš„ç¯å¢ƒå˜é‡å€¼ï¼ˆå·²ä» .env åŠ è½½ï¼‰
  1170: # å¦åˆ™ä¿æŒç°æœ‰çš„ç¯å¢ƒå˜é‡å€¼ï¼ˆå·²ä» .env åŠ è½½ï¼‰
  1175: # å¯¹äº AUTO_SAVE_AUTHï¼Œåªæœ‰åœ¨è°ƒè¯•æ¨¡å¼ä¸”é€šè¿‡å‘½ä»¤è¡Œæ˜ç¡®æŒ‡å®šæ—¶æ‰è¦†ç›–
  1178: # å¦åˆ™ä¿æŒç°æœ‰çš„ç¯å¢ƒå˜é‡å€¼ï¼ˆå·²ä» .env åŠ è½½ï¼‰

.\launcher\checks.py: 17 lines
  14: logger.debug(f"æ´»åŠ¨è®¤è¯ç›®å½•å°±ç»ª: {ACTIVE_AUTH_DIR}")
  16: logger.debug(f"å·²ä¿å­˜è®¤è¯ç›®å½•å°±ç»ª: {SAVED_AUTH_DIR}")
  18: logger.error(f"åˆ›å»ºè®¤è¯ç›®å½•å¤±è´¥: {e}", exc_info=True)
  25: logger.debug("[Init] æ­¥éª¤ 1: æ£€æŸ¥ä¾èµ–é¡¹...")
  32: "  'camoufox.server' å·²å¯¼å…¥ï¼Œä½† 'camoufox.DefaultAddons' æœªå¯¼å…¥ã€‚æ’é™¤æ’ä»¶åŠŸèƒ½å¯èƒ½å—é™ã€‚"
  40: logger.debug(f"æ¨¡å— '{module_name}' å·²æ‰¾åˆ°ã€‚")
  43: f"  æ¨¡å— '{module_name}' (åŒ…: '{install_package_name}') æœªæ‰¾åˆ°ã€‚"
  48: # æ£€æŸ¥æ˜¯å¦æ˜¯å†…éƒ¨å¯åŠ¨æ¨¡å¼ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ camoufox å¿…é¡»å¯å¯¼å…¥
  52: "  å†…éƒ¨å¯åŠ¨æ¨¡å¼ (--internal-*) éœ€è¦ 'camoufox' åŒ…ï¼Œä½†æœªèƒ½å¯¼å…¥ã€‚"
  57: "æœªè¯·æ±‚å†…éƒ¨å¯åŠ¨æ¨¡å¼ï¼Œä¸”æœªå¯¼å…¥ camoufox.serverï¼Œè·³è¿‡å¯¹ 'camoufox' Python åŒ…çš„æ£€æŸ¥ã€‚"
  64: logger.debug("[Init] æˆåŠŸä» server.py å¯¼å…¥ app å¯¹è±¡")
  67: f"  æ— æ³•ä» 'server.py' å¯¼å…¥ 'app' å¯¹è±¡: {e_import_server}", exc_info=True
  69: logger.error("è¯·ç¡®ä¿ 'server.py' æ–‡ä»¶å­˜åœ¨ä¸”æ²¡æœ‰å¯¼å…¥é”™è¯¯ã€‚")
  74: logger.error("ä¾èµ–é¡¹æ£€æŸ¥å¤±è´¥ï¼")
  76: logger.error(f"ç¼ºå°‘çš„ Python åº“: {', '.join(missing_py_modules)}")
  78: f"   è¯·å°è¯•ä½¿ç”¨ pip å®‰è£…: pip install {' '.join(missing_py_modules)}"
  83: logger.debug("[Init] æ‰€æœ‰ä¾èµ–é¡¹æ£€æŸ¥é€šè¿‡")

.\launcher\frontend_build.py: 23 lines
  52: """æ£€æŸ¥å‰ç«¯æ˜¯å¦éœ€è¦é‡æ–°æ„å»ºã€‚"""
  67: """æ£€æŸ¥ npm æ˜¯å¦å¯ç”¨ã€‚"""
  73: é‡æ–°æ„å»ºå‰ç«¯ã€‚
  79: logger.warning(f"å‰ç«¯ç›®å½•ä¸å­˜åœ¨: {_FRONTEND_DIR}")
  83: logger.warning("npm æœªå®‰è£…ï¼Œè·³è¿‡å‰ç«¯é‡å»º")
  88: logger.info("[Build] æ­£åœ¨å®‰è£…å‰ç«¯ä¾èµ–...")
  98: logger.error(f"npm install å¤±è´¥: {result.stderr}")
  101: logger.error("npm install è¶…æ—¶")
  104: logger.error(f"npm install å‡ºé”™: {e}")
  107: logger.info("[Build] æ­£åœ¨æ„å»ºå‰ç«¯...")
  117: logger.info("[Build] å‰ç«¯æ„å»ºæˆåŠŸ")
  126: logger.error(f"å‰ç«¯æ„å»ºå¤±è´¥:\n{error_output}")
  128: logger.error(f"å‰ç«¯æ„å»ºå¤±è´¥ (exit code: {result.returncode})")
  131: logger.error("å‰ç«¯æ„å»ºè¶…æ—¶")
  134: logger.error(f"å‰ç«¯æ„å»ºå‡ºé”™: {e}")
  140: ç¡®ä¿å‰ç«¯å·²æ„å»ºä¸”ä¸ºæœ€æ–°ã€‚
  142: å¦‚æœæºæ–‡ä»¶æ¯” dist æ›´æ–°ï¼Œåˆ™è‡ªåŠ¨é‡å»ºã€‚
  145: skip_build: å¦‚æœä¸º Trueï¼Œè·³è¿‡æ‰€æœ‰æ„å»ºæ£€æŸ¥ã€‚
  146: ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡ SKIP_FRONTEND_BUILD=1 æ¥è·³è¿‡ã€‚
  156: logger.info("[Build] è·³è¿‡å‰ç«¯æ„å»ºæ£€æŸ¥ (SKIP_FRONTEND_BUILD)")
  160: logger.debug("[Build] æœªæ‰¾åˆ°å‰ç«¯æºç›®å½•ï¼Œè·³è¿‡æ„å»ºæ£€æŸ¥")
  164: logger.info("[Build] æ£€æµ‹åˆ°å‰ç«¯æºæ–‡ä»¶æ›´æ–°ï¼Œæ­£åœ¨é‡å»º...")
  167: logger.info("[Build] å‰ç«¯å·²æ˜¯æœ€æ–°")

.\launcher\logging_setup.py: 7 lines
  14: è®¾ç½®å¯åŠ¨å™¨æ—¥å¿—ç³»ç»Ÿ (ä½¿ç”¨ GridFormatter)
  17: log_level: æ—¥å¿—çº§åˆ«
  21: # è®¾ç½® source ä¸º LAUNCHER
  24: # ä½¿ç”¨ PlainGridFormatter ç”¨äºæ–‡ä»¶æ—¥å¿—
  27: # ä½¿ç”¨ GridFormatter ç”¨äºæ§åˆ¶å° (å½©è‰²è¾“å‡º)
  55: logger.info(f"æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º: {logging.getLevelName(logger.getEffectiveLevel())}")
  56: logger.debug(f"æ—¥å¿—æ–‡ä»¶è·¯å¾„: {LAUNCHER_LOG_FILE_PATH}")

.\launcher\process.py: 41 lines
  16: def _enqueue_output(stream, stream_name, output_queue, process_pid_for_log="<æœªçŸ¥PID>"):
  17: log_prefix = f"[è¯»å–çº¿ç¨‹-{stream_name}-PID:{process_pid_for_log}]"
  27: f"{log_prefix} è§£ç é”™è¯¯: {decode_err}ã€‚åŸå§‹æ•°æ® (å‰100å­—èŠ‚): {line_bytes[:100]}"
  30: (stream_name, f"[è§£ç é”™è¯¯: {decode_err}] {line_bytes[:100]}...\n")
  33: logger.debug(f"{log_prefix} ValueError (æµå¯èƒ½å·²å…³é—­)ã€‚")
  35: logger.error(f"{log_prefix} è¯»å–æµæ—¶å‘ç”Ÿæ„å¤–é”™è¯¯: {e}", exc_info=True)
  43: logger.debug(f"{log_prefix} çº¿ç¨‹é€€å‡ºã€‚")
  100: # æ„å»º Camoufox å†…éƒ¨å¯åŠ¨å‘½ä»¤ (from dev)
  124: f"å°†æ‰§è¡Œ Camoufox å†…éƒ¨å¯åŠ¨å‘½ä»¤: {' '.join(camoufox_internal_cmd_args)}"
  130: f"Camoufox å†…éƒ¨è¿›ç¨‹å·²å¯åŠ¨ (PID: {self.camoufox_proc.pid})ã€‚æ­£åœ¨ç­‰å¾… WebSocket ç«¯ç‚¹è¾“å‡º (æœ€é•¿ {ENDPOINT_CAPTURE_TIMEOUT} ç§’)..."
  162: f"  Camoufox å†…éƒ¨è¿›ç¨‹ (PID: {self.camoufox_proc.pid}) åœ¨ç­‰å¾… WebSocket ç«¯ç‚¹æœŸé—´å·²æ„å¤–é€€å‡ºï¼Œé€€å‡ºç : {self.camoufox_proc.poll()}ã€‚"
  170: f"  [InternalCamoufox-{stream_name}-PID:{self.camoufox_proc.pid}] è¾“å‡ºæµå·²å…³é—­ (EOF)ã€‚"
  174: f"  Camoufox å†…éƒ¨è¿›ç¨‹ (PID: {self.camoufox_proc.pid}) çš„æ‰€æœ‰è¾“å‡ºæµå‡å·²å…³é—­ã€‚"
  183: "[å†…éƒ¨Camoufoxå¯åŠ¨]" in log_content
  184: or "ä¼ é€’ç»™ launch_server" in log_content
  198: f"æˆåŠŸä» Camoufox å†…éƒ¨è¿›ç¨‹æ•è·åˆ° WebSocket ç«¯ç‚¹: {self.captured_ws_endpoint[:40]}..."
  200: logger.info("[å†…æ ¸] WebSocket ç«¯ç‚¹è·å–æˆåŠŸ")
  214: f"  æœªèƒ½åœ¨ {ENDPOINT_CAPTURE_TIMEOUT} ç§’å†…ä» Camoufox å†…éƒ¨è¿›ç¨‹ (PID: {self.camoufox_proc.pid}) æ•è·åˆ° WebSocket ç«¯ç‚¹ã€‚"
  217: "  Camoufox å†…éƒ¨è¿›ç¨‹ä»åœ¨è¿è¡Œï¼Œä½†æœªè¾“å‡ºé¢„æœŸçš„ WebSocket ç«¯ç‚¹ã€‚è¯·æ£€æŸ¥å…¶æ—¥å¿—æˆ–è¡Œä¸ºã€‚"
  224: logger.error("Camoufox å†…éƒ¨è¿›ç¨‹å·²é€€å‡ºï¼Œä¸”æœªèƒ½æ•è·åˆ° WebSocket ç«¯ç‚¹ã€‚")
  227: logger.error("æœªèƒ½æ•è·åˆ° WebSocket ç«¯ç‚¹ã€‚")
  232: f"  åœ¨å†…éƒ¨å¯åŠ¨ Camoufox æˆ–æ•è·å…¶ WebSocket ç«¯ç‚¹æ—¶å‘ç”Ÿè‡´å‘½é”™è¯¯: {e_launch_camoufox_internal}",
  241: logger.info("--- å¼€å§‹æ‰§è¡Œæ¸…ç†ç¨‹åº (CamoufoxProcessManager) ---")
  244: logger.info(f"æ­£åœ¨ç»ˆæ­¢ Camoufox è¿›ç¨‹æ ‘ (PID: {pid})...")
  247: # Windows: ç›´æ¥å¼ºåˆ¶ç»ˆæ­¢ï¼Œä¸å°è¯•ä¼˜é›…å…³é—­ï¼ˆheadless æµè§ˆå™¨å¸¸æŒ‚èµ·ï¼‰
  256: logger.info("è¿›ç¨‹æ ‘å·²æˆåŠŸç»ˆæ­¢ã€‚")
  258: logger.warning("taskkill è¶…æ—¶ï¼Œè¿›ç¨‹å¯èƒ½å·²ç»ˆæ­¢ã€‚")
  260: logger.warning(f"taskkill æ‰§è¡Œå¼‚å¸¸: {e}")
  262: # Unix: å°è¯• SIGTERMï¼Œè¶…æ—¶å SIGKILL
  267: logger.info(f"è¿›ç¨‹ç»„ (PGID: {pgid}) å·²é€šè¿‡ SIGTERM æˆåŠŸç»ˆæ­¢ã€‚")
  269: logger.warning("SIGTERM è¶…æ—¶ï¼Œæ­£åœ¨å‘é€ SIGKILL...")
  273: logger.info("è¿›ç¨‹ç»„å·²é€šè¿‡ SIGKILL æˆåŠŸç»ˆæ­¢ã€‚")
  277: logger.info("è¿›ç¨‹ç»„æœªæ‰¾åˆ°ï¼Œå¯èƒ½å·²è‡ªè¡Œé€€å‡ºã€‚")
  279: # Fallback: ç›´æ¥ç»ˆæ­¢è¿›ç¨‹
  283: logger.info("è¿›ç¨‹å·²æˆåŠŸç»ˆæ­¢ã€‚")
  286: logger.info("è¿›ç¨‹å·²å¼ºåˆ¶ç»ˆæ­¢ã€‚")
  288: logger.warning(f"ç»ˆæ­¢è¿›ç¨‹æ—¶å‘ç”Ÿé”™è¯¯: {e_term}")
  290: # æ¸…ç†æµ
  300: f"Camoufox å†…éƒ¨å­è¿›ç¨‹å…ˆå‰å·²è‡ªè¡Œç»“æŸï¼Œé€€å‡ºç : {self.camoufox_proc.poll()}ã€‚"
  304: logger.info("Camoufox å†…éƒ¨å­è¿›ç¨‹æœªè¿è¡Œæˆ–å·²æ¸…ç†ã€‚")
  305: logger.info("--- æ¸…ç†ç¨‹åºæ‰§è¡Œå®Œæ¯• (CamoufoxProcessManager) ---")

.\launcher\utils.py: 32 lines
  22: logger.warning(f"æ£€æŸ¥ç«¯å£ {port} (ä¸»æœº {host}) æ—¶å‘ç”ŸæœªçŸ¥é”™è¯¯: {e}")
  45: "command not found" in stderr.lower() or "æœªæ‰¾åˆ°å‘½ä»¤" in stderr
  47: logger.error("å‘½ä»¤ 'lsof' æœªæ‰¾åˆ°ã€‚è¯·ç¡®ä¿å·²å®‰è£…ã€‚")
  48: elif process.returncode not in [0, 1]:  # lsof åœ¨æœªæ‰¾åˆ°æ—¶è¿”å›1
  50: f"æ‰§è¡Œ lsof å‘½ä»¤å¤±è´¥ (è¿”å›ç  {process.returncode}): {stderr.strip()}"
  72: pids = list(set(pids))  # å»é‡
  73: elif process.returncode not in [0, 1]:  # findstr åœ¨æœªæ‰¾åˆ°æ—¶è¿”å›1
  75: f"æ‰§è¡Œ netstat/findstr å‘½ä»¤å¤±è´¥ (è¿”å›ç  {process.returncode}): {stderr.strip()}"
  79: f"ä¸æ”¯æŒçš„æ“ä½œç³»ç»Ÿ '{system_platform}' ç”¨äºæŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹ã€‚"
  82: cmd_name = command.split()[0] if command else "ç›¸å…³å·¥å…·"
  83: logger.error(f"å‘½ä»¤ '{cmd_name}' æœªæ‰¾åˆ°ã€‚")
  85: logger.error(f"æ‰§è¡Œå‘½ä»¤ '{command}' è¶…æ—¶ã€‚")
  87: logger.error(f"æŸ¥æ‰¾å ç”¨ç«¯å£ {port} çš„è¿›ç¨‹æ—¶å‡ºé”™: {e}", exc_info=True)
  94: logger.info(f"å°è¯•ç»ˆæ­¢è¿›ç¨‹ PID: {pid}...")
  106: logger.info(f"PID {pid} å·²å‘é€ SIGTERM ä¿¡å·ã€‚")
  110: f"    PID {pid} SIGTERM å¤±è´¥: {result_term.stderr.strip() or result_term.stdout.strip()}. å°è¯• SIGKILL..."
  121: logger.info(f"PID {pid} å·²å‘é€ SIGKILL ä¿¡å·ã€‚")
  125: f"    âœ— PID {pid} SIGKILL å¤±è´¥: {result_kill.stderr.strip() or result_kill.stdout.strip()}."
  140: "SUCCESS" in output.upper() or "æˆåŠŸ" in output
  142: logger.info(f"PID {pid} å·²é€šè¿‡ taskkill /F ç»ˆæ­¢ã€‚")
  146: or "æ‰¾ä¸åˆ°" in error_output
  147: ):  # è¿›ç¨‹å¯èƒ½å·²è‡ªè¡Œé€€å‡º
  148: logger.info(f"PID {pid} æ‰§è¡Œ taskkill æ—¶æœªæ‰¾åˆ° (å¯èƒ½å·²é€€å‡º)ã€‚")
  149: success = True  # è§†ä¸ºæˆåŠŸï¼Œå› ä¸ºç›®æ ‡æ˜¯ç«¯å£å¯ç”¨
  151: # ç»Ÿè®¡é”™è¯¯æ•°é‡è€Œéé€ä¸ªè¾“å‡º
  156: f"    PID {pid} taskkill /F: (æŠ‘åˆ¶ {error_count} æ¡é”™è¯¯ä¿¡æ¯)"
  159: logger.warning(f"PID {pid} taskkill /F è¿”å›éé›¶çŠ¶æ€")
  161: logger.warning(f"ä¸æ”¯æŒçš„æ“ä½œç³»ç»Ÿ '{system_platform}' ç”¨äºç»ˆæ­¢è¿›ç¨‹ã€‚")
  163: logger.error(f"ç»ˆæ­¢ PID {pid} æ—¶å‘ç”Ÿæ„å¤–é”™è¯¯: {e}", exc_info=True)
  176: user_input_container[0] = ""  # å‡ºé”™æ—¶è¿”å›ç©ºå­—ç¬¦ä¸²
  182: print("\nè¾“å…¥è¶…æ—¶ã€‚å°†ä½¿ç”¨é»˜è®¤å€¼ã€‚", flush=True)
  190: print("\nè¾“å…¥è¶…æ—¶ã€‚å°†ä½¿ç”¨é»˜è®¤å€¼ã€‚", flush=True)

.\logging_utils\__init__.py: 1 lines
  1: # æ—¥å¿—è®¾ç½®åŠŸèƒ½

.\logging_utils\core\error_handler.py: 4 lines
  82: logger.debug("[Snapshot] æ— æ³•ä¿å­˜é”™è¯¯å¿«ç…§: æ— è¿è¡Œäº‹ä»¶å¾ªç¯")
  88: logger.debug(f"[Snapshot] ä¿å­˜é”™è¯¯å¿«ç…§å¤±è´¥: {snapshot_err}")
  210: logger.debug("[Init] å…¨å±€å¼‚å¸¸å¤„ç†å™¨å·²å®‰è£… (Asyncio)")
  220: logger.debug("[Init] å…¨å±€å¼‚å¸¸å¤„ç†å™¨å·²å®‰è£… (Threading)")

.\scripts\llm_mock.py: 1 lines
  191: role = msg.get("role", "æœªçŸ¥")


Total: 21 files, 402 lines with Chinese
